import{m as ie,o as pe,d as me,l as p,r as d,b as O,c as G,e as r,a as l,w as t,f as h,g as L,p as g,z as J,n as m,B as c,a1 as Re,q as u,am as de,s as A,W as Fe,X as Pe,ak as re,a2 as N,aj as ze,k as w,E as U,a3 as Y,a4 as R,a5 as Qe}from"./index-DpLe_dtH.js";import{l as We,u as Xe,a as Ge,b as Je,c as Ye,d as Ze,e as je,f as el,g as ll}from"./index-DaxHQChT.js";import{l as tl}from"./index-DLTENZBC.js";function al(F){let K=ie({});return pe(async()=>{if(F.length>0)for(const B of F){const I=await tl(B);I.data!=null&&(K[B]=I.data)}}),{koiDicts:K}}const nl={class:"koi-flex"},ol={class:"flex flex-justify-center"},ul={key:0},sl={class:"flex items-center m-b-15px m-l-8px"},dl=me({name:"menuPage"}),ml=me({...dl,setup(F){const{koiDicts:K}=al(["sys_menu_type"]),B=p(!1),I=p(!0),Z=p([{menuId:1,menuName:"系统管理🌻",menuType:"1",icon:"Tools",auth:"system:menu:list",component:"system/menu/Index",isSpread:"1",menuStatus:"0",isHide:"1",path:"system",sorted:1,children:[{menuId:3,menuName:"用户管理🌻",menuType:"2",icon:"UserFilled",auth:"system:menu:list",component:"system/menu/Index",isSpread:"1",menuStatus:"0",isHide:"1",path:"system",sorted:3},{menuId:4,menuName:"角色管理🌻",menuType:"2",icon:"CameraFilled",auth:"system:menu:list",component:"system/menu/Index",isSpread:"1",menuStatus:"0",isHide:"1",path:"system",sorted:4},{menuId:9,menuName:"菜单管理🌻",menuType:"2",icon:"Menu",auth:"system:menu:list",component:"system/menu/Index",isSpread:"1",menuStatus:"0",isHide:"1",path:"system",sorted:5}]},{menuId:2,menuName:"监控管理🌻",menuType:"1",icon:"Search",auth:"system:menu:list",component:"system/menu/Index",isSpread:"1",menuStatus:"0",isHide:"1",path:"system",sorted:2,children:[{menuId:5,menuName:"熊出没🌻",menuType:"2",icon:"CameraFilled",auth:"system:menu:list",component:"system/menu/Index",isSpread:"1",menuStatus:"0",isHide:"1",path:"system",sorted:6},{menuId:6,menuName:"海绵宝宝🌻",menuType:"2",icon:"Menu",auth:"system:menu:list",component:"system/menu/Index",isSpread:"1",menuStatus:"0",isHide:"1",path:"system",sorted:7}]}]),x=p({menuName:"",auth:"",menuStatus:""}),ce=()=>{x.value={menuName:"",auth:"",menuStatus:""}},fe=()=>{D()},_e=()=>{ce(),k()},k=async()=>{},D=async()=>{try{const n=await We(x.value);ve(n.data),Z.value=re(n.data,"menuId")}catch{N("数据查询失败，请刷新重试🌻")}},E=p(),ve=n=>{if(n!=null&&n.length!=0){E.value=[];const e=[];n.forEach(s=>{s.parentId=="0"&&s.isSpread=="0"&&e.push(s.menuId),s.parentId!="0"&&s.isSpread=="0"&&(e.push(s.menuId),e.push(s.parentId))});const _=[...new Set(e)];E.value=_.map(String)}else E.value=[]};pe(()=>{k()});const q=p([]),j=p(!0),ee=p(!0),ye=n=>{q.value=n.map(e=>e.menuId),j.value=n.length!=1,ee.value=!n.length},he=n=>{o.value.icon=n};let $=p([]);const le=async()=>{try{$.value=[];const n=await el();n.data!=null&&n.data!=null&&n.data.length>0&&($.value=re(n.data,"value")),$.value.unshift({label:"最顶级菜单",value:"0",parentId:"-1"})}catch{U("菜单级联数据查询失败，请重试🌻")}},P=p(!0),z=p(!1),ge=()=>{P.value=!1,z.value=!z.value,ze(()=>{P.value=!0})},xe=()=>{H(),o.value.icon="Aim",W.value="菜单添加",le(),o.value.menuStatus="0",T.value.koiOpen(),o.value.icon="",setTimeout(()=>{Q.value.resetIcon()},0),w("添加🌻")},Q=p(),be=async n=>{if(n==null||n==""){R("请选择需要修改的数据🌻");return}try{const e=await ll(n);o.value=e.data,setTimeout(()=>{Q.value.echoIcon(o.value.icon)},0)}catch{N("数据获取失败，请刷新重试🌻")}},te=async n=>{H(),W.value="菜单修改";const e=n?n.menuId:q.value[0];(e==null||e=="")&&U("请选择需要修改的数据🌻"),le(),be(e),T.value.koiOpen(),w("修改🌻")},T=p(),W=p("菜单管理"),X=p();let o=p();const H=()=>{o.value={parentId:"0",menuType:"2",icon:null,menuName:null,name:null,path:null,component:null,isHide:"1",isLink:null,isKeepAlive:"0",isSpread:"1",auth:null,isFull:"1",isAffix:"1",sorted:1}},we=ie({parentId:[{required:!0,message:"请选择上级菜单",trigger:"blur"}],menuType:[{required:!0,message:"请选择菜单类型",trigger:"blur"}],menuName:[{required:!0,message:"请输入菜单名称",trigger:"blur"}],isHide:[{required:!0,message:"请选择是否隐藏",trigger:"blur"}],auth:[{required:!0,message:"请输入权限字符",trigger:"blur"}],sorted:[{required:!0,message:"请输入排序号",trigger:"blur"}]}),S=p(!1),ke=()=>{X.value&&(S.value=!0,X.value.validate(async n=>{if(n)if(o.value.menuId!=null&&o.value.menuId!="")try{await Xe(o.value),w("修改成功🌻"),S.value=!1,T.value.koiQuickClose(),H(),k()}catch{S.value=!1,N("修改失败，请刷新重试🌻")}else try{await Ge(o.value),w("添加成功🌻"),S.value=!1,T.value.koiQuickClose(),H(),k()}catch{S.value=!1,N("添加失败，请刷新重试🌻")}else U("验证失败，请检查填写内容🌻"),S.value=!1}))},Se=()=>{T.value.koiClose()},Ve=n=>{let e=n.menuStatus==="0"?"启用":"停用";Y("确认要["+e+"]-["+n.menuName+"]菜单吗？").then(async()=>{if(H(),!n.menuId||!n.menuStatus){R("请选择需要修改的数据🌻");return}try{await Je(n.menuId,n.menuStatus),w("修改成功🌻")}catch{N("修改失败，请刷新重试🌻")}}).catch(()=>{U("已取消🌻")})},Ie=async n=>{if(!n.menuId||!n.isSpread){R("请选择需要展开的数据🌻");return}try{await Ye(n.menuId,n.isSpread),D(),w("操作成功🌻")}catch{N("操作失败，请刷新重试🌻")}},Te=n=>{const e=n.menuId;if(e==null||e==""){R("请选中需要删除的数据🌻");return}Y("您确认需要删除菜单名称["+n.menuName+"]么？").then(async()=>{try{await Ze(e),w("删除成功🌻"),D()}catch{}}).catch(()=>{U("已取消🌻")})},Ce=()=>{if(q.value.length==0){Qe("请选择需要删除的数据🌻");return}Y("您确认需要进行批量删除么？删除后将无法进行恢复？").then(async()=>{try{await je(q.value),w("批量删除成功🌻"),D()}catch{}}).catch(()=>{U("已取消🌻")})};return(n,e)=>{const _=d("el-input"),s=d("el-form-item"),ae=d("el-option"),Ne=d("el-select"),b=d("el-button"),ne=d("el-form"),i=d("el-col"),Ue=d("KoiToolbar"),y=d("el-row"),f=d("el-table-column"),Ke=d("KoiTag"),oe=d("el-switch"),ue=d("el-icon"),De=d("el-tag"),se=d("el-tooltip"),He=d("el-table"),Le=d("el-cascader"),V=d("el-radio"),M=d("el-radio-group"),Ae=d("KoiIcon"),Be=d("el-input-number"),Ee=d("KoiDialog"),qe=d("KoiCard"),$e=O("throttle"),Me=O("debounce"),C=O("auth"),Oe=O("loading");return r(),G("div",nl,[l(qe,null,{default:t(()=>[h(l(ne,{inline:!0},{default:t(()=>[l(s,{label:"菜单名称",prop:"menuName"},{default:t(()=>[l(_,{placeholder:"请输入菜单名称",modelValue:x.value.menuName,"onUpdate:modelValue":e[0]||(e[0]=a=>x.value.menuName=a),clearable:"",style:{width:"240px"},onKeyup:J(k,["enter","native"])},null,8,["modelValue"])]),_:1}),l(s,{label:"菜单状态",prop:"menuStatus"},{default:t(()=>[l(Ne,{placeholder:"请选择菜单状态",modelValue:x.value.menuStatus,"onUpdate:modelValue":e[1]||(e[1]=a=>x.value.menuStatus=a),clearable:"",style:{width:"240px"},onKeyup:J(k,["enter","native"])},{default:t(()=>[l(ae,{label:"启用",value:"0"}),l(ae,{label:"停用",value:"1"})]),_:1},8,["modelValue"])]),_:1}),l(s,{label:"权限标识",prop:"auth"},{default:t(()=>[l(_,{placeholder:"请输入权限标识",modelValue:x.value.auth,"onUpdate:modelValue":e[2]||(e[2]=a=>x.value.auth=a),clearable:"",style:{width:"240px"},onKeyup:J(k,["enter","native"])},null,8,["modelValue"])]),_:1}),l(s,null,{default:t(()=>[h((r(),m(b,{type:"primary",icon:"search",plain:""},{default:t(()=>e[20]||(e[20]=[c("搜索")])),_:1,__:[20]})),[[$e,fe]]),h((r(),m(b,{type:"danger",icon:"refresh",plain:""},{default:t(()=>e[21]||(e[21]=[c("重置")])),_:1,__:[21]})),[[Me,_e]])]),_:1})]),_:1},512),[[Re,I.value]]),l(y,{gutter:10},{default:t(()=>[h((r(),m(i,{span:1.5},{default:t(()=>[l(b,{type:"primary",icon:"plus",plain:"",onClick:e[3]||(e[3]=a=>xe())},{default:t(()=>e[22]||(e[22]=[c("新增")])),_:1,__:[22]})]),_:1})),[[C,["system:role:add"]]]),h((r(),m(i,{span:1.5},{default:t(()=>[l(b,{type:"success",icon:"edit",plain:"",onClick:e[4]||(e[4]=a=>te()),disabled:j.value},{default:t(()=>e[23]||(e[23]=[c("修改")])),_:1,__:[23]},8,["disabled"])]),_:1})),[[C,["system:role:update"]]]),h((r(),m(i,{span:1.5},{default:t(()=>[l(b,{type:"danger",icon:"delete",plain:"",onClick:e[5]||(e[5]=a=>Ce()),disabled:ee.value},{default:t(()=>e[24]||(e[24]=[c("删除")])),_:1,__:[24]},8,["disabled"])]),_:1})),[[C,["system:role:delete"]]]),h((r(),m(i,{span:1.5},{default:t(()=>[l(b,{type:"info",icon:"Sort",plain:"",onClick:e[6]||(e[6]=a=>ge())},{default:t(()=>e[25]||(e[25]=[c("展开/折叠")])),_:1,__:[25]})]),_:1})),[[C,["system:role:add"]]]),l(Ue,{showSearch:I.value,"onUpdate:showSearch":e[7]||(e[7]=a=>I.value=a),onRefreshTable:D},null,8,["showSearch"])]),_:1}),e[33]||(e[33]=L("br",null,null,-1)),P.value?h((r(),m(He,{key:0,border:"",data:Z.value,onSelectionChange:ye,"default-expand-all":z.value,"expand-row-keys":E.value,"row-key":"menuId","tree-props":{children:"children",hasChildren:"hasChildren"},"empty-text":"暂时没有数据哟🌻"},{default:t(()=>[l(f,{type:"selection",width:"55",align:"center"}),l(f,{label:"序号",prop:"menuId",width:"80px",align:"center",type:"index"}),l(f,{label:"菜单名称",prop:"menuName",width:"160px",align:"left","show-overflow-tooltip":!0}),l(f,{label:"菜单类型",prop:"menuType",width:"100px",align:"center"},{default:t(a=>[l(Ke,{tagOptions:u(K).sys_menu_type,value:a.row.menuType},null,8,["tagOptions","value"])]),_:1}),l(f,{label:"展开/折叠",prop:"isSpread",width:"100px",align:"center"},{default:t(a=>[l(oe,{modelValue:a.row.isSpread,"onUpdate:modelValue":v=>a.row.isSpread=v,"active-text":"展开","inactive-text":"折叠","active-value":"0","inactive-value":"1","inline-prompt":!0,onClick:v=>Ie(a.row)},null,8,["modelValue","onUpdate:modelValue","onClick"])]),_:1}),l(f,{label:"图标",prop:"icon",width:"80px",align:"center"},{default:t(a=>[L("div",ol,[a.row.icon&&a.row.icon.indexOf("koi-")=="-1"?(r(),m(ue,{key:0,size:20},{default:t(()=>[(r(),m(de(a.row.icon)))]),_:2},1024)):g("",!0),a.row.icon&&a.row.icon.indexOf("koi-")=="0"?(r(),m(ue,{key:1,size:20},{default:t(()=>[(r(),m(de("SvgIcon"),{name:a.row.icon},null,8,["name"]))]),_:2},1024)):g("",!0)])]),_:1}),l(f,{label:"权限标识",prop:"auth",width:"220px",align:"center","show-overflow-tooltip":!0}),l(f,{label:"页面路径",prop:"component",width:"220px",align:"center","show-overflow-tooltip":!0}),l(f,{label:"菜单状态",prop:"menuStatus",width:"100px",align:"center"},{default:t(a=>[l(oe,{modelValue:a.row.menuStatus,"onUpdate:modelValue":v=>a.row.menuStatus=v,"active-text":"启用","inactive-text":"停用","active-value":"0","inactive-value":"1","inline-prompt":!0,onClick:v=>Ve(a.row)},null,8,["modelValue","onUpdate:modelValue","onClick"])]),_:1}),l(f,{label:"是否隐藏",prop:"isHide",width:"100px",align:"center","show-overflow-tooltip":!0},{default:t(a=>[l(De,{type:a.row.isHide=="0"?"danger":a.row.isHide=="1"?"primary":"warning"},{default:t(()=>[c(A(a.row.isHide=="0"?"隐藏":a.row.isHide=="1"?"显示":"未知状态"),1)]),_:2},1032,["type"])]),_:1}),l(f,{label:"路由path",prop:"path",width:"180px",align:"center","show-overflow-tooltip":!0}),l(f,{label:"显示顺序",prop:"sorted",width:"90px",align:"center"}),l(f,{label:"操作",align:"center",width:"120",fixed:"right"},{default:t(({row:a})=>[l(se,{content:"修改🌻",placement:"top"},{default:t(()=>[h(l(b,{type:"primary",icon:"Edit",circle:"",plain:"",onClick:v=>te(a)},null,8,["onClick"]),[[C,["system:role:update"]]])]),_:2},1024),l(se,{content:"删除🌻",placement:"top"},{default:t(()=>[h(l(b,{type:"danger",icon:"Delete",circle:"",plain:"",onClick:v=>Te(a)},null,8,["onClick"]),[[C,["system:role:delete"]]])]),_:2},1024)]),_:1})]),_:1},8,["data","default-expand-all","expand-row-keys"])),[[Oe,B.value]]):g("",!0),l(Ee,{ref_key:"koiDialogRef",ref:T,title:W.value,onKoiConfirm:ke,onKoiCancel:Se,loading:S.value,height:500},{content:t(()=>[l(ne,{ref_key:"formRef",ref:X,rules:we,model:u(o),"label-width":"auto","status-icon":""},{default:t(()=>[l(y,null,{default:t(()=>[l(i,{xs:{span:24},sm:{span:24}},{default:t(()=>[l(s,{label:"菜单上级",prop:"parentId"},{default:t(()=>[l(Le,{placeholder:"请选择菜单上级",modelValue:u(o).parentId,"onUpdate:modelValue":e[8]||(e[8]=a=>u(o).parentId=a),options:u($),props:{expandTrigger:"hover",emitPath:!1,checkStrictly:!0},filterable:"",clearable:"",style:{width:"540px"}},{default:t(({node:a,data:v})=>[L("span",null,A(v.label),1),a.isLeaf?g("",!0):(r(),G("span",ul," ("+A(v.children.length)+") ",1))]),_:1},8,["modelValue","options"])]),_:1})]),_:1})]),_:1}),l(y,null,{default:t(()=>[l(i,{xs:{span:24},sm:{span:24}},{default:t(()=>[l(s,{label:"菜单类型",prop:"menuType"},{default:t(()=>[l(M,{modelValue:u(o).menuType,"onUpdate:modelValue":e[9]||(e[9]=a=>u(o).menuType=a)},{default:t(()=>[(r(!0),G(Fe,null,Pe(u(K).sys_menu_type,(a,v)=>(r(),m(V,{key:a.dictValue+v,value:a.dictValue,border:""},{default:t(()=>[c(A(a.dictLabel),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(y,null,{default:t(()=>[u(o).menuType<3?(r(),m(i,{key:0,xs:{span:24},sm:{span:24}},{default:t(()=>[L("div",sl,[l(s,{prop:"icon"}),e[26]||(e[26]=L("div",{class:"w-78px"},"菜单图标",-1)),l(Ae,{ref_key:"koiIconRef",ref:Q,onSelected:he},null,512)])]),_:1})):g("",!0)]),_:1}),l(y,null,{default:t(()=>[l(i,{xs:{span:24},sm:{span:12}},{default:t(()=>[l(s,{label:"菜单名称",prop:"menuName"},{default:t(()=>[l(_,{modelValue:u(o).menuName,"onUpdate:modelValue":e[10]||(e[10]=a=>u(o).menuName=a),placeholder:"请输入菜单名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(i,{xs:{span:24},sm:{span:12}},{default:t(()=>[l(s,{label:"显示排序",prop:"sorted",class:"p-l-10px"},{default:t(()=>[l(Be,{modelValue:u(o).sorted,"onUpdate:modelValue":e[11]||(e[11]=a=>u(o).sorted=a),clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(y,null,{default:t(()=>[l(i,{xs:{span:24},sm:{span:12}},{default:t(()=>[l(s,{label:"是否隐藏",prop:"isHide"},{default:t(()=>[l(M,{modelValue:u(o).isHide,"onUpdate:modelValue":e[12]||(e[12]=a=>u(o).isHide=a)},{default:t(()=>[l(V,{value:"0"},{default:t(()=>e[27]||(e[27]=[c("是")])),_:1,__:[27]}),l(V,{value:"1"},{default:t(()=>e[28]||(e[28]=[c("否")])),_:1,__:[28]})]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(i,{xs:{span:24},sm:{span:12},class:"p-l-10px"},{default:t(()=>[l(s,{label:"权限字符",prop:"auth"},{default:t(()=>[l(_,{modelValue:u(o).auth,"onUpdate:modelValue":e[13]||(e[13]=a=>u(o).auth=a),placeholder:"权限字符[system:user:list]",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),u(o).menuType=="2"?(r(),m(y,{key:0},{default:t(()=>[l(i,{xs:{span:24},sm:{span:24}},{default:t(()=>[l(s,{label:"页面路径",prop:"component"},{default:t(()=>[l(_,{modelValue:u(o).component,"onUpdate:modelValue":e[14]||(e[14]=a=>u(o).component=a),placeholder:"请输入页面路径[system/user/index]",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})):g("",!0),u(o).menuType<3?(r(),m(y,{key:1},{default:t(()=>[l(i,{xs:{span:24},sm:{span:12}},{default:t(()=>[l(s,{label:"路由名称",prop:"name"},{default:t(()=>[l(_,{modelValue:u(o).name,"onUpdate:modelValue":e[15]||(e[15]=a=>u(o).name=a),placeholder:"例如：user[唯一]",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(i,{xs:{span:24},sm:{span:12},class:"p-l-10px"},{default:t(()=>[l(s,{label:"路由Path",prop:"path"},{default:t(()=>[l(_,{modelValue:u(o).path,"onUpdate:modelValue":e[16]||(e[16]=a=>u(o).path=a),placeholder:"例如：/user[唯一]",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})):g("",!0),l(y,null,{default:t(()=>[u(o).menuType<3?(r(),m(i,{key:0,xs:{span:24},sm:{span:12}},{default:t(()=>[l(s,{label:"是否折叠",prop:"isSpread"},{default:t(()=>[l(M,{modelValue:u(o).isSpread,"onUpdate:modelValue":e[17]||(e[17]=a=>u(o).isSpread=a)},{default:t(()=>[l(V,{value:"0"},{default:t(()=>e[29]||(e[29]=[c("是")])),_:1,__:[29]}),l(V,{value:"1"},{default:t(()=>e[30]||(e[30]=[c("否")])),_:1,__:[30]})]),_:1},8,["modelValue"])]),_:1})]),_:1})):g("",!0),u(o).menuType<3?(r(),m(i,{key:1,xs:{span:24},sm:{span:12},class:"p-l-10px"},{default:t(()=>[l(s,{label:"是否固钉",prop:"isAffix"},{default:t(()=>[l(M,{modelValue:u(o).isAffix,"onUpdate:modelValue":e[18]||(e[18]=a=>u(o).isAffix=a)},{default:t(()=>[l(V,{value:"0"},{default:t(()=>e[31]||(e[31]=[c("是")])),_:1,__:[31]}),l(V,{value:"1"},{default:t(()=>e[32]||(e[32]=[c("否")])),_:1,__:[32]})]),_:1},8,["modelValue"])]),_:1})]),_:1})):g("",!0)]),_:1}),l(y,null,{default:t(()=>[l(i,{xs:{span:24},sm:{span:24}},{default:t(()=>[l(s,{label:"外链地址",prop:"isLink"},{default:t(()=>[l(_,{modelValue:u(o).isLink,"onUpdate:modelValue":e[19]||(e[19]=a=>u(o).isLink=a),placeholder:"请输入外链地址[输入值则判断为外链地址]",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["rules","model"]),c(" "+A(u(o)),1)]),_:1},8,["title","loading"])]),_:1,__:[33]})])}}});export{ml as default};
