import{a5 as C,d as B,l as d,o as ne,r as a,b as h,c as ie,e as c,a as t,w as l,f as p,g as P,z as k,n as f,B as b,G as M,s as re,M as se,L as z,k as U,K as x,E as T,N as de,a7 as pe}from"./index-D1FNYxzU.js";const ue=u=>C.get("/koi/sysLoginLog/listPage",u),ge=u=>C.post("/koi/sysLoginLog/deleteById/"+u),ce=u=>C.post("/koi/sysLoginLog/batchDelete",u),me={class:"koi-flex"},_e=B({name:"loginlogPage"}),he=B({..._e,setup(u){const K=d(!1),y=d(!0),D=d([{loginId:1,loginName:"YU-ADMIN🌻",ipAddress:"127.0.0.1",loginAddress:"河南省 郑州市",loginStatus:"0",deviceName:"PC",browser:"Chrome 11",os:"Windows 10",message:"YU-ADMIN🌻",loginTime:"2023-08-08 23:00:00"},{loginId:2,loginName:"张大仙🌻",ipAddress:"127.0.0.1",loginAddress:"河南省 郑州市",loginStatus:"0",deviceName:"PC",browser:"Chrome 11",os:"Windows 10",message:"YU-ADMIN🌻",loginTime:"2023-08-08 23:00:00"},{loginId:3,loginName:"王将🌻",ipAddress:"127.0.0.1",loginAddress:"河南省 郑州市",loginStatus:"0",deviceName:"PC",browser:"Chrome 11",os:"Windows 10",message:"YU-ADMIN🌻",loginTime:"2023-08-08 23:00:00"}]),n=d({pageNo:1,pageSize:10,loginName:"",ipAddress:"",loginStatus:""}),m=d(0),_=d(),L=()=>{_.value=[],n.value={pageNo:1,pageSize:10,loginName:"",ipAddress:"",loginStatus:""}},Y=()=>{n.value.pageNo=1,s()},E=()=>{L(),s()},s=async()=>{m.value=200},v=async()=>{try{const i=await ue(pe(n.value,_.value));D.value=i.data.records,m.value=i.data.total}catch{x("数据查询失败，请刷新重试🌻")}};ne(()=>{s()});const S=d([]),W=d(!0),A=d(!0),H=i=>{S.value=i.map(e=>e.loginId),W.value=i.length!=1,A.value=!i.length},R=i=>{const e=i.loginId;if(e==null||e==""){se("请选中需要删除的数据🌻");return}z("您确认需要删除用户名称["+i.loginName+"]么？").then(async()=>{try{await ge(e),v(),U("删除成功🌻")}catch{v(),x("删除失败，请刷新重试🌻")}}).catch(()=>{T("已取消🌻")})},$=()=>{if(S.value.length==0){de("请选择需要删除的数据🌻");return}z("您确认需要进行批量删除么？").then(async()=>{try{await ce(S.value),v(),U("批量删除成功🌻")}catch{x("批量删除失败，请刷新重试🌻"),v()}}).catch(()=>{T("已取消🌻")})};return(i,e)=>{const N=a("el-input"),g=a("el-form-item"),I=a("el-option"),j=a("el-select"),G=a("el-date-picker"),w=a("el-button"),q=a("el-form"),F=a("el-col"),J=a("KoiToolbar"),O=a("el-row"),r=a("el-table-column"),Q=a("el-tag"),X=a("el-tooltip"),Z=a("el-table"),ee=a("el-pagination"),te=a("KoiCard"),oe=h("debounce"),le=h("throttle"),V=h("auth"),ae=h("loading");return c(),ie("div",me,[t(te,null,{default:l(()=>[p(t(q,{inline:!0},{default:l(()=>[t(g,{label:"用户名称",prop:"loginName"},{default:l(()=>[t(N,{placeholder:"请输入用户名称",modelValue:n.value.loginName,"onUpdate:modelValue":e[0]||(e[0]=o=>n.value.loginName=o),style:{width:"200px"},clearable:"",onKeyup:k(s,["enter","native"])},null,8,["modelValue"])]),_:1}),t(g,{label:"IP地址",prop:"ipAddress"},{default:l(()=>[t(N,{placeholder:"请输入IP地址",modelValue:n.value.ipAddress,"onUpdate:modelValue":e[1]||(e[1]=o=>n.value.ipAddress=o),style:{width:"200px"},clearable:"",onKeyup:k(s,["enter","native"])},null,8,["modelValue"])]),_:1}),t(g,{label:"登录状态",prop:"loginStatus"},{default:l(()=>[t(j,{placeholder:"请选择日志状态",modelValue:n.value.loginStatus,"onUpdate:modelValue":e[2]||(e[2]=o=>n.value.loginStatus=o),style:{width:"200px"},clearable:"",onKeyup:k(s,["enter","native"])},{default:l(()=>[t(I,{label:"登录成功",value:"0"}),t(I,{label:"登录失败",value:"1"})]),_:1},8,["modelValue"])]),_:1}),t(g,{label:"访问时间",prop:"loginTime"},{default:l(()=>[t(G,{modelValue:_.value,"onUpdate:modelValue":e[3]||(e[3]=o=>_.value=o),type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss","start-placeholder":"开始日期","range-separator":"至","end-placeholder":"结束日期","default-time":[new Date(2e3,1,1,0,0,0),new Date(2e3,1,1,23,59,59)]},null,8,["modelValue","default-time"])]),_:1}),t(g,null,{default:l(()=>[p((c(),f(w,{type:"primary",icon:"search",plain:""},{default:l(()=>e[8]||(e[8]=[b("搜索")])),_:1,__:[8]})),[[oe,Y]]),p((c(),f(w,{type:"danger",icon:"refresh",plain:""},{default:l(()=>e[9]||(e[9]=[b("重置")])),_:1,__:[9]})),[[le,E]])]),_:1})]),_:1},512),[[M,y.value]]),t(O,{gutter:10},{default:l(()=>[p((c(),f(F,{span:1.5},{default:l(()=>[t(w,{type:"danger",icon:"delete",plain:"",onClick:e[4]||(e[4]=o=>$()),disabled:A.value},{default:l(()=>e[10]||(e[10]=[b("删除")])),_:1,__:[10]},8,["disabled"])]),_:1})),[[V,["system:role:delete"]]]),t(J,{showSearch:y.value,"onUpdate:showSearch":e[5]||(e[5]=o=>y.value=o),onRefreshTable:s},null,8,["showSearch"])]),_:1}),e[11]||(e[11]=P("br",null,null,-1)),p((c(),f(Z,{border:"",data:D.value,"empty-text":"暂时没有数据哟🌻",onSelectionChange:H},{default:l(()=>[t(r,{type:"selection",width:"55",align:"center"}),t(r,{label:"序号",prop:"loginId",width:"80px",align:"center",type:"index"}),t(r,{label:"登录用户",prop:"loginName",width:"130px",align:"center","show-overflow-tooltip":!0}),t(r,{label:"IP地址",prop:"ipAddress",width:"160px",align:"center","show-overflow-tooltip":!0}),t(r,{label:"登录地址",prop:"loginAddress",width:"260px",align:"center","show-overflow-tooltip":!0}),t(r,{label:"登录状态",prop:"loginStatus",width:"100px",align:"center","show-overflow-tooltip":!0},{default:l(o=>[t(Q,{type:o.row.loginStatus=="0"?"primary":o.row.loginStatus=="1"?"danger":"warning"},{default:l(()=>[b(re(o.row.loginStatus=="0"?"登录成功":o.row.loginStatus=="1"?"登录失败":"未知状态"),1)]),_:2},1032,["type"])]),_:1}),t(r,{label:"设备名称",prop:"deviceName",width:"150px",align:"center","show-overflow-tooltip":!0}),t(r,{label:"浏览器",prop:"browser",width:"150px",align:"center","show-overflow-tooltip":!0}),t(r,{label:"操作系统",prop:"os",width:"150px",align:"center","show-overflow-tooltip":!0}),t(r,{label:"登录信息",prop:"message",width:"150px",align:"center","show-overflow-tooltip":!0}),t(r,{label:"登录时间",prop:"loginTime",width:"180px",align:"center"}),t(r,{label:"操作",align:"center",width:"120",fixed:"right"},{default:l(({row:o})=>[t(X,{content:"删除🌻",placement:"top"},{default:l(()=>[p(t(w,{type:"danger",icon:"Delete",circle:"",plain:"",onClick:ve=>R(o)},null,8,["onClick"]),[[V,["system:role:delete"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[ae,K.value]]),e[12]||(e[12]=P("br",null,null,-1)),p(t(ee,{background:"","current-page":n.value.pageNo,"onUpdate:currentPage":e[6]||(e[6]=o=>n.value.pageNo=o),"page-size":n.value.pageSize,"onUpdate:pageSize":e[7]||(e[7]=o=>n.value.pageSize=o),"page-sizes":[10,20,50,100,200],layout:"total, sizes, prev, pager, next, jumper",total:m.value,onSizeChange:s,onCurrentChange:s},null,8,["current-page","page-size","total"]),[[M,m.value>0]])]),_:1,__:[11,12]})])}}});export{he as default};
