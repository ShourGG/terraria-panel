import{a5 as x,d as de,l as u,o as Te,m as Ke,r as s,b as A,c as te,e as _,a as e,w as t,f as v,g as ae,p as ne,z as Q,n as S,B as w,G as Be,q as r,s as z,a4 as Me,k as b,E as C,K as D,L as F,M as L,N as Ee,a6 as oe}from"./index-rAFU2v1v.js";const qe=p=>x.get("/koi/sysDept/list",p),Ae=()=>x.get("/koi/sysDept/cascaderList"),Le=p=>x.get("/koi/sysDept/getById/"+p),$e=p=>x.post("/koi/sysDept/update",p),Re=p=>x.post("/koi/sysDept/add",p),Ye=p=>x.post("/koi/sysDept/deleteById/"+p),Pe=p=>x.post("/koi/sysDept/batchDelete",p),Oe=(p,U)=>x.post("/koi/sysDept/updateStatus/"+p+"/"+U),Qe=(p,U)=>x.post("/koi/sysDept/updateSpread/"+p+"/"+U),ze={class:"koi-flex"},Fe={key:0},Ge=de({name:"deptPage"}),He=de({...Ge,setup(p){const U=u(!1),$=u(!0),G=u([{id:1,deptId:1,deptName:"YU-ADMINðŸŒ»",leader:"YU-ADMIN",phone:"18588888888",email:"xxxxxx@163.com",deptStatus:"0",isSpread:"1",sorted:1,remark:"æˆ‘æ˜¯å¤©æ‰ðŸŒ»",createTime:"2023-08-08 23:00:00",children:[{id:3,deptId:3,deptName:"ç ”å‘éƒ¨é—¨ðŸŒ»",leader:"YU-ADMIN",phone:"18588888888",email:"xxxxxx@163.com",deptStatus:"0",isSpread:"1",sorted:1,remark:"æˆ‘æ˜¯å¤©æ‰ðŸŒ»",createTime:"2023-08-08 23:00:00"},{id:4,deptId:4,deptName:"é”€å”®éƒ¨é—¨ðŸŒ»",leader:"è™Žç‰™688å¼ å¤§ä»™",phone:"18566666666",email:"666666@163.com",deptStatus:"0",isSpread:"1",sorted:1,remark:"æˆ‘æ˜¯å¤©æ‰ðŸŒ»",createTime:"2023-08-08 23:00:00"}]},{id:2,deptId:2,deptName:"ç¥–å®‰å…¬å¸ðŸŒ»",leader:"YU-ADMIN",phone:"18577777777",email:"xxxxxx@163.com",deptStatus:"0",isSpread:"1",sorted:1,remark:"æˆ‘æ˜¯å¤©æ‰ðŸŒ»",createTime:"2023-08-08 23:00:00",children:[{id:5,deptId:5,deptName:"è¿ç»´éƒ¨é—¨ðŸŒ»",leader:"YU-ADMIN",phone:"18577777777",email:"xxxxxx@163.com",deptStatus:"0",isSpread:"1",sorted:1,remark:"æˆ‘æ˜¯å¤©æ‰ðŸŒ»",createTime:"2023-08-08 23:00:00"},{id:6,deptId:6,deptName:"æµ‹è¯•éƒ¨é—¨ðŸŒ»",leader:"è™Žç‰™688å¼ å¤§ä»™",phone:"18577777777",email:"666666@163.com",deptStatus:"0",isSpread:"1",sorted:1,remark:"æˆ‘æ˜¯å¤©æ‰ðŸŒ»",createTime:"2023-08-08 23:00:00"}]}]),g=u({deptName:"",phone:"",deptStatus:""}),re=()=>{g.value={deptName:"",phone:"",deptStatus:""}},se=()=>{h()},pe=()=>{re(),h()},h=async()=>{},T=async()=>{try{const n=await qe(g.value);G.value=oe(n.data,"deptId"),ue(n.data)}catch{D("æ•°æ®æŸ¥è¯¢å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ðŸŒ»")}},B=u(),ue=n=>{if(n!=null&&n.length!=0){B.value=[];const l=[];n.forEach(d=>{d.parentId=="0"&&d.isSpread=="0"&&l.push(d.deptId),d.parentId!="0"&&d.isSpread=="0"&&(l.push(d.deptId),l.push(d.parentId))});const m=[...new Set(l)];B.value=m.map(String)}else B.value=[]};Te(()=>{h()});const M=u([]),W=u(!0),H=u(!0),ie=n=>{M.value=n.map(l=>l.id),W.value=n.length!=1,H.value=!n.length};let E=u([]);const J=async()=>{try{E.value=[];const n=await Ae();E.value=oe(n.data,"value"),E.value.unshift({label:"æœ€é¡¶çº§éƒ¨é—¨",value:"0",parentId:"-1"})}catch{C("éƒ¨é—¨çº§è”æ•°æ®æŸ¥è¯¢å¤±è´¥ï¼Œè¯·é‡è¯•ðŸŒ»")}},R=u(!0),Y=u(!1),ce=()=>{R.value=!1,Y.value=!Y.value,Me(()=>{R.value=!0})},me=()=>{K(),P.value="éƒ¨é—¨æ·»åŠ ",J(),o.value.parentId="0",o.value.deptStatus="0",V.value.koiOpen(),b("æ·»åŠ ðŸŒ»")},fe=async n=>{if(n==null||n==""){L("è¯·é€‰æ‹©éœ€è¦ä¿®æ”¹çš„æ•°æ®ðŸŒ»");return}try{const l=await Le(n);o.value=l.data}catch{D("æ•°æ®èŽ·å–å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ðŸŒ»")}},X=async n=>{K(),P.value="éƒ¨é—¨ä¿®æ”¹";const l=n?n.id:M.value[0];(l==null||l=="")&&C("è¯·é€‰æ‹©éœ€è¦ä¿®æ”¹çš„æ•°æ®ðŸŒ»"),J(),fe(l),V.value.koiOpen(),b("ä¿®æ”¹ðŸŒ»")},V=u(),P=u("éƒ¨é—¨ç®¡ç†"),O=u();let o=u({id:null,deptId:null,deptName:null,parentId:null,deptStatus:"0",leader:null,phone:null,email:null,sorted:1});const K=()=>{o.value={id:null,deptId:null,deptName:null,parentId:null,deptStatus:null,leader:null,phone:null,email:null,sorted:1}},ve=Ke({deptId:[{required:!0,message:"è¯·è¾“å…¥éƒ¨é—¨ç¼–å·",trigger:"blur"}],deptName:[{required:!0,message:"è¯·è¾“å…¥éƒ¨é—¨åå­—",trigger:"blur"}],parentId:[{required:!0,message:"è¯·é€‰æ‹©ä¸Šçº§éƒ¨é—¨",trigger:"blur"}],deptStatus:[{required:!0,message:"è¯·è¾“å…¥é€‰æ‹©éƒ¨é—¨çŠ¶æ€",trigger:"blur"}],leader:[{required:!0,message:"è¯·è¾“å…¥è´Ÿè´£äººåå­—",trigger:"blur"}],phone:[{required:!0,message:"è¯·è¾“å…¥æ‰‹æœºå·ç ",trigger:"blur"}],sorted:[{required:!0,message:"è¯·è¾“å…¥æŽ’åºå·",trigger:"blur"}]}),k=u(!1),he=()=>{O.value&&(k.value=!0,O.value.validate(async n=>{if(n)if(o.value.id!=null&&o.value.id!="")try{await $e(o.value),b("ä¿®æ”¹æˆåŠŸðŸŒ»"),k.value=!1,V.value.koiQuickClose(),K(),h()}catch{k.value=!1,D("ä¿®æ”¹å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ðŸŒ»")}else try{await Re(o.value),b("æ·»åŠ æˆåŠŸðŸŒ»"),k.value=!1,V.value.koiQuickClose(),K(),h()}catch{k.value=!1,D("æ·»åŠ å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ðŸŒ»")}else C("éªŒè¯å¤±è´¥ï¼Œè¯·æ£€æŸ¥å¡«å†™å†…å®¹ðŸŒ»"),k.value=!1}))},_e=()=>{V.value.koiClose()},xe=n=>{let l=n.deptStatus==="0"?"å¯ç”¨":"åœç”¨";F("ç¡®è®¤è¦["+l+"]-["+n.deptName+"]éƒ¨é—¨å—ï¼Ÿ").then(async()=>{if(K(),!n.id||!n.deptStatus){L("è¯·é€‰æ‹©éœ€è¦ä¿®æ”¹çš„æ•°æ®ðŸŒ»");return}try{await Oe(n.id,n.deptStatus),b("ä¿®æ”¹æˆåŠŸðŸŒ»")}catch{T(),D("ä¿®æ”¹å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ðŸŒ»")}}).catch(()=>{C("å·²å–æ¶ˆðŸŒ»")})},ge=async n=>{if(!n.id||!n.isSpread){L("è¯·é€‰æ‹©éœ€è¦å±•å¼€çš„æ•°æ®ðŸŒ»");return}try{await Qe(n.id,n.isSpread),T(),b("æ“ä½œæˆåŠŸðŸŒ»")}catch{T(),D("æ“ä½œå¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ðŸŒ»")}},ye=n=>{const l=n.id;if(l==null||l==""){L("è¯·é€‰ä¸­éœ€è¦åˆ é™¤çš„æ•°æ®ðŸŒ»");return}F("æ‚¨ç¡®è®¤éœ€è¦åˆ é™¤éƒ¨é—¨åç§°["+n.deptName+"]ä¹ˆï¼Ÿ").then(async()=>{try{await Ye(l),b("åˆ é™¤æˆåŠŸðŸŒ»"),T()}catch{}}).catch(()=>{C("å·²å–æ¶ˆðŸŒ»")})},be=()=>{if(M.value.length==0){Ee("è¯·é€‰æ‹©éœ€è¦åˆ é™¤çš„æ•°æ®ðŸŒ»");return}F("æ‚¨ç¡®è®¤éœ€è¦è¿›è¡Œæ‰¹é‡åˆ é™¤ä¹ˆï¼Ÿåˆ é™¤åŽå°†æ— æ³•è¿›è¡Œæ¢å¤ï¼Ÿ").then(async()=>{try{await Pe(M.value),b("æ‰¹é‡åˆ é™¤æˆåŠŸðŸŒ»"),T()}catch{}}).catch(()=>{C("å·²å–æ¶ˆðŸŒ»")})};return(n,l)=>{const m=s("el-input"),d=s("el-form-item"),q=s("el-option"),Z=s("el-select"),y=s("el-button"),j=s("el-form"),i=s("el-col"),ke=s("KoiToolbar"),I=s("el-row"),c=s("el-table-column"),ee=s("el-switch"),le=s("el-tooltip"),Se=s("el-table"),we=s("el-cascader"),Ve=s("el-input-number"),Ie=s("KoiDialog"),Ne=s("KoiCard"),Ce=A("throttle"),De=A("debounce"),N=A("auth"),Ue=A("loading");return _(),te("div",ze,[e(Ne,null,{default:t(()=>[v(e(j,{inline:!0},{default:t(()=>[e(d,{label:"éƒ¨é—¨åç§°",prop:"deptName"},{default:t(()=>[e(m,{placeholder:"è¯·è¾“å…¥éƒ¨é—¨åç§°",modelValue:g.value.deptName,"onUpdate:modelValue":l[0]||(l[0]=a=>g.value.deptName=a),clearable:"",style:{width:"240px"},onKeyup:Q(h,["enter","native"])},null,8,["modelValue"])]),_:1}),e(d,{label:"éƒ¨é—¨çŠ¶æ€",prop:"deptStatus"},{default:t(()=>[e(Z,{placeholder:"è¯·é€‰æ‹©éƒ¨é—¨çŠ¶æ€",modelValue:g.value.deptStatus,"onUpdate:modelValue":l[1]||(l[1]=a=>g.value.deptStatus=a),clearable:"",style:{width:"240px"},onKeyup:Q(h,["enter","native"])},{default:t(()=>[e(q,{label:"å¯ç”¨",value:"0"}),e(q,{label:"åœç”¨",value:"1"})]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"è”ç³»ç”µè¯",prop:"phone"},{default:t(()=>[e(m,{placeholder:"è¯·è¾“å…¥è”ç³»ç”µè¯",modelValue:g.value.phone,"onUpdate:modelValue":l[2]||(l[2]=a=>g.value.phone=a),clearable:"",style:{width:"240px"},onKeyup:Q(h,["enter","native"])},null,8,["modelValue"])]),_:1}),e(d,null,{default:t(()=>[v((_(),S(y,{type:"primary",icon:"search",plain:""},{default:t(()=>l[17]||(l[17]=[w("æœç´¢")])),_:1,__:[17]})),[[Ce,se]]),v((_(),S(y,{type:"danger",icon:"refresh",plain:""},{default:t(()=>l[18]||(l[18]=[w("é‡ç½®")])),_:1,__:[18]})),[[De,pe]])]),_:1})]),_:1},512),[[Be,$.value]]),e(I,{gutter:10},{default:t(()=>[v((_(),S(i,{span:1.5},{default:t(()=>[e(y,{type:"primary",icon:"plus",plain:"",onClick:l[3]||(l[3]=a=>me())},{default:t(()=>l[19]||(l[19]=[w("æ–°å¢ž")])),_:1,__:[19]})]),_:1})),[[N,["system:role:add"]]]),v((_(),S(i,{span:1.5},{default:t(()=>[e(y,{type:"success",icon:"edit",plain:"",onClick:l[4]||(l[4]=a=>X()),disabled:W.value},{default:t(()=>l[20]||(l[20]=[w("ä¿®æ”¹")])),_:1,__:[20]},8,["disabled"])]),_:1})),[[N,["system:role:update"]]]),v((_(),S(i,{span:1.5},{default:t(()=>[e(y,{type:"danger",icon:"delete",plain:"",onClick:l[5]||(l[5]=a=>be()),disabled:H.value},{default:t(()=>l[21]||(l[21]=[w("åˆ é™¤")])),_:1,__:[21]},8,["disabled"])]),_:1})),[[N,["system:role:delete"]]]),v((_(),S(i,{span:1.5},{default:t(()=>[e(y,{type:"info",icon:"Sort",plain:"",onClick:l[6]||(l[6]=a=>ce())},{default:t(()=>l[22]||(l[22]=[w("å±•å¼€/æŠ˜å ")])),_:1,__:[22]})]),_:1})),[[N,["system:role:add"]]]),e(ke,{showSearch:$.value,"onUpdate:showSearch":l[7]||(l[7]=a=>$.value=a),onRefreshTable:h},null,8,["showSearch"])]),_:1}),l[23]||(l[23]=ae("br",null,null,-1)),R.value?v((_(),S(Se,{key:0,border:"",data:G.value,onSelectionChange:ie,"expand-row-keys":B.value,"default-expand-all":Y.value,"row-key":"deptId","tree-props":{children:"children",hasChildren:"hasChildren"},"empty-text":"æš‚æ—¶æ²¡æœ‰æ•°æ®å“ŸðŸŒ»"},{default:t(()=>[e(c,{type:"selection",width:"55",align:"center"}),e(c,{label:"åºå·",prop:"id",width:"80px",align:"center",type:"index"}),e(c,{label:"éƒ¨é—¨åç§°",prop:"deptName",width:"150px",align:"left","show-overflow-tooltip":!0}),e(c,{label:"å±•å¼€/æŠ˜å ",prop:"isSpread",width:"100px",align:"center"},{default:t(a=>[e(ee,{modelValue:a.row.isSpread,"onUpdate:modelValue":f=>a.row.isSpread=f,"active-text":"å±•å¼€","inactive-text":"æŠ˜å ","active-value":"0","inactive-value":"1","inline-prompt":!0,onClick:f=>ge(a.row)},null,8,["modelValue","onUpdate:modelValue","onClick"])]),_:1}),e(c,{label:"éƒ¨é—¨ç¼–å·",prop:"deptId",width:"100px",align:"center"}),e(c,{label:"è´Ÿè´£äºº",prop:"leader",width:"120px",align:"center"}),e(c,{label:"è”ç³»ç”µè¯",prop:"phone",width:"120px",align:"center"}),e(c,{label:"é‚®ç®±",prop:"email",width:"230px",align:"center","show-overflow-tooltip":!0}),e(c,{label:"éƒ¨é—¨çŠ¶æ€",prop:"deptStatus",width:"100px",align:"center"},{default:t(a=>[e(ee,{modelValue:a.row.deptStatus,"onUpdate:modelValue":f=>a.row.deptStatus=f,"active-text":"å¯ç”¨","inactive-text":"åœç”¨","active-value":"0","inactive-value":"1","inline-prompt":!0,onChange:f=>xe(a.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(c,{label:"æ˜¾ç¤ºé¡ºåº",prop:"sorted",width:"100px",align:"center"}),e(c,{label:"å¤‡æ³¨",prop:"remark",width:"180px",align:"center","show-overflow-tooltip":!0}),e(c,{label:"åˆ›å»ºæ—¶é—´",prop:"createTime",width:"180px",align:"center"}),e(c,{label:"æ“ä½œ",align:"center",width:"120",fixed:"right"},{default:t(({row:a})=>[e(le,{content:"ä¿®æ”¹ðŸŒ»",placement:"top"},{default:t(()=>[v(e(y,{type:"primary",icon:"Edit",circle:"",plain:"",onClick:f=>X(a)},null,8,["onClick"]),[[N,["system:role:update"]]])]),_:2},1024),e(le,{content:"åˆ é™¤ðŸŒ»",placement:"top"},{default:t(()=>[v(e(y,{type:"danger",icon:"Delete",circle:"",plain:"",onClick:f=>ye(a)},null,8,["onClick"]),[[N,["system:role:delete"]]])]),_:2},1024)]),_:1})]),_:1},8,["data","expand-row-keys","default-expand-all"])),[[Ue,U.value]]):ne("",!0),e(Ie,{ref_key:"koiDialogRef",ref:V,title:P.value,onKoiConfirm:he,onKoiCancel:_e,loading:k.value},{content:t(()=>[e(j,{ref_key:"formRef",ref:O,rules:ve,model:r(o),"label-width":"80px","status-icon":""},{default:t(()=>[e(I,null,{default:t(()=>[e(i,{xs:{span:24},sm:{span:12}},{default:t(()=>[e(d,{label:"éƒ¨é—¨ç¼–ç ",prop:"deptId"},{default:t(()=>[e(m,{modelValue:r(o).deptId,"onUpdate:modelValue":l[8]||(l[8]=a=>r(o).deptId=a),placeholder:"è¯·è¾“å…¥éƒ¨é—¨ç¼–ç ",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{xs:{span:24},sm:{span:12},class:"p-l-10px"},{default:t(()=>[e(d,{label:"éƒ¨é—¨åç§°",prop:"deptName"},{default:t(()=>[e(m,{modelValue:r(o).deptName,"onUpdate:modelValue":l[9]||(l[9]=a=>r(o).deptName=a),placeholder:"è¯·è¾“å…¥éƒ¨é—¨åç§°",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(I,null,{default:t(()=>[e(i,{xs:{span:24},sm:{span:24}},{default:t(()=>[e(d,{label:"éƒ¨é—¨ä¸Šçº§",prop:"parentId"},{default:t(()=>[e(we,{placeholder:"è¯·é€‰æ‹©éƒ¨é—¨ä¸Šçº§",modelValue:r(o).parentId,"onUpdate:modelValue":l[10]||(l[10]=a=>r(o).parentId=a),options:r(E),props:{expandTrigger:"hover",emitPath:!1,checkStrictly:!0},filterable:"",clearable:"",style:{width:"540px"}},{default:t(({node:a,data:f})=>[ae("span",null,z(f.label),1),a.isLeaf?ne("",!0):(_(),te("span",Fe," ("+z(f.children.length)+") ",1))]),_:1},8,["modelValue","options"])]),_:1})]),_:1})]),_:1}),e(I,null,{default:t(()=>[e(i,{xs:{span:24},sm:{span:12}},{default:t(()=>[e(d,{label:"éƒ¨é—¨çŠ¶æ€",prop:"deptStatus"},{default:t(()=>[e(Z,{modelValue:r(o).deptStatus,"onUpdate:modelValue":l[11]||(l[11]=a=>r(o).deptStatus=a),placeholder:"è¯·é€‰æ‹©éƒ¨é—¨çŠ¶æ€",style:{width:"260px"},clearable:""},{default:t(()=>[e(q,{label:"å¯ç”¨",value:"0"}),e(q,{label:"åœç”¨",value:"1"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(i,{xs:{span:24},sm:{span:12},class:"p-l-10px"},{default:t(()=>[e(d,{label:"è´Ÿè´£äºº",prop:"leader"},{default:t(()=>[e(m,{modelValue:r(o).leader,"onUpdate:modelValue":l[12]||(l[12]=a=>r(o).leader=a),placeholder:"è¯·è¾“å…¥éƒ¨é—¨è´Ÿè´£äºº",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(I,null,{default:t(()=>[e(i,{xs:{span:24},sm:{span:12}},{default:t(()=>[e(d,{label:"æ‰‹æœºå·ç ",prop:"phone"},{default:t(()=>[e(m,{modelValue:r(o).phone,"onUpdate:modelValue":l[13]||(l[13]=a=>r(o).phone=a),placeholder:"è¯·è¾“å…¥æ‰‹æœºå·ç ",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{xs:{span:24},sm:{span:12},class:"p-l-10px"},{default:t(()=>[e(d,{label:"é‚®ç®±åœ°å€",prop:"email"},{default:t(()=>[e(m,{modelValue:r(o).email,"onUpdate:modelValue":l[14]||(l[14]=a=>r(o).email=a),placeholder:"è¯·è¾“å…¥é‚®ç®±åœ°å€",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(I,null,{default:t(()=>[e(i,{xs:{span:24},sm:{span:12}},{default:t(()=>[e(d,{label:"æ˜¾ç¤ºæŽ’åº",prop:"sorted"},{default:t(()=>[e(Ve,{modelValue:r(o).sorted,"onUpdate:modelValue":l[15]||(l[15]=a=>r(o).sorted=a),style:{width:"260px"},clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{xs:{span:24},sm:{span:12},class:"p-l-10px"},{default:t(()=>[e(d,{label:"å¤‡æ³¨",prop:"remark"},{default:t(()=>[e(m,{modelValue:r(o).remark,"onUpdate:modelValue":l[16]||(l[16]=a=>r(o).remark=a),placeholder:"è¯·è¾“å…¥å¤‡æ³¨",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["rules","model"]),w(" "+z(r(o)),1)]),_:1},8,["title","loading"])]),_:1,__:[23]})])}}});export{He as default};
