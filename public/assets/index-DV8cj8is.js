import{a5 as h,d as ae,l as u,o as Ie,E as I,m as Ne,r as i,b as A,c as R,e as d,a as t,w as a,f as p,g as X,z as $,I as Z,J as ee,n as g,B as k,G as te,q as s,s as Ue,K as T,R as le,k as U,L as O,M as q,N as De}from"./index-rAFU2v1v.js";const Be=r=>h.get("/koi/sysNotice/listPage",r),Ke=r=>h.get("/koi/sysNotice/getById/"+r),Me=r=>h.post("/koi/sysNotice/update",r),ze=r=>h.post("/koi/sysNotice/add",r),Ae=r=>h.post("/koi/sysNotice/deleteById/"+r),Le=r=>h.post("/koi/sysNotice/batchDelete",r),Pe=(r,L)=>h.post("/koi/sysNotice/updateStatus/"+r+"/"+L),Ye={class:"koi-flex"},Ee=ae({name:"noticePage"}),$e=ae({...Ee,setup(r){const L=u(!1),P=u(!0),F=u([{noticeId:3,noticeTitle:"ElementPlus全新经典UI🌻",noticeType:"2",noticeContent:"走过路过，千万不要错过🌻",noticeStatus:"0",sorted:3,createBy:"YU-ADMIN🌻",createTime:"2023-08-22 11:27:24",updateBy:"",updateTime:"2023-08-16 18:36:50",remark:"YU-ADMIN🌻"},{noticeId:2,noticeTitle:"维护通知：2023-11-23 YU-ADMIN将持续进行维护",noticeType:"2",noticeContent:"维护内容",noticeStatus:"0",sorted:2,createBy:"YU-ADMIN🌻",createTime:"2023-08-22 11:27:24",updateBy:"",updateTime:null,remark:"YU-ADMIN🌻"},{noticeId:1,noticeTitle:"温馨提醒：2023-11-23 YU-ADMIN生日",noticeType:"1",noticeContent:"新版本内容",noticeStatus:"0",sorted:1,createBy:"YU-ADMIN🌻",createTime:"2023-08-22 11:27:24",updateBy:"",updateTime:null,remark:"YU-ADMIN🌻"}]),c=u({pageNo:1,pageSize:10,noticeTitle:"",noticeStatus:"",noticeType:""}),D=u(0),oe=()=>{c.value={pageNo:1,pageSize:10,noticeTitle:"",noticeStatus:"",noticeType:""}},ne=()=>{c.value.pageNo=1,w()},ie=()=>{oe(),m()},m=async()=>{D.value=100},w=async()=>{try{const o=await Be(c.value);F.value=o.data.records,D.value=o.data.total}catch{T("数据查询失败，请刷新重试🌻")}};Ie(()=>{m(),re()});const B=u(),re=async()=>{try{B.value=[{dictLabel:"通知",dictValue:"1",dictTag:"primary",dictColor:""},{dictLabel:"公告",dictValue:"2",dictTag:"warning",dictColor:""}]}catch{I("数据字典查询失败，请刷新重试🌻")}},K=u([]),Q=u(!0),j=u(!0),ue=o=>{K.value=o.map(e=>e.noticeId),Q.value=o.length!=1,j.value=!o.length},se=()=>{N(),Y.value="公告添加",n.value.noticeStatus="0",S.value.koiOpen(),le("添加🌻")},ce=async o=>{if(o==null||o==""){q("请选择需要修改的数据🌻");return}try{const e=await Ke(o);n.value=e.data}catch{T("数据获取失败，请刷新重试🌻")}},G=async o=>{N(),Y.value="公告修改";const e=o?o.noticeId:K.value[0];(e==null||e=="")&&I("请选中需要修改的数据🌻"),ce(e),S.value.koiOpen(),le("修改🌻")},S=u(),Y=u("公告类型管理"),E=u();let n=u({noticeTitle:null,noticeType:null,noticeStatus:null,noticeContent:null,sorted:1,remark:null});const N=()=>{n.value={noticeTitle:null,noticeType:null,noticeStatus:null,noticeContent:null,sorted:1,remark:null}},de=Ne({noticeTitle:[{required:!0,message:"请输入公告名称",trigger:"blur"}],noticeType:[{required:!0,message:"请输入公告类型",trigger:"blur"}],noticeStatus:[{required:!0,message:"请输入选择公告状态",trigger:"blur"}]}),b=u(!1),pe=()=>{E.value&&(b.value=!0,E.value.validate(async o=>{if(o)if(n.value.noticeId!=null&&n.value.noticeId!="")try{await Me(n.value),U("修改成功🌻"),b.value=!1,S.value.koiQuickClose(),N(),m()}catch{b.value=!1,T("修改失败，请刷新重试🌻")}else try{await ze(n.value),U("添加成功🌻"),b.value=!1,S.value.koiQuickClose(),N(),m()}catch{b.value=!1,T("添加失败，请刷新重试🌻")}else I("验证失败，请检查填写内容🌻"),b.value=!1}))},me=()=>{S.value.koiClose()},ve=o=>{let e=o.noticeStatus==="0"?"启用":"停用";O("确认要["+e+"]-["+o.noticeTitle+"]吗？").then(async()=>{if(N(),!o.noticeId||!o.noticeStatus){q("请选择需要修改的数据🌻");return}try{await Pe(o.noticeId,o.noticeStatus),U("修改成功🌻")}catch{w(),T("修改失败，请刷新重试🌻")}}).catch(()=>{I("已取消🌻")})},fe=o=>{const e=o.noticeId;if(e==null||e==""){q("请选中需要删除的数据🌻");return}O("您确认需要删除公告名称["+o.noticeTitle+"]么？").then(async()=>{try{await Ae(e),w(),U("删除成功🌻")}catch{w(),T("删除失败，请刷新重试🌻")}}).catch(()=>{I("已取消🌻")})},ye=()=>{if(K.value.length==0){De("请选择需要删除的数据🌻");return}O("您确认需要进行批量删除么？").then(async()=>{try{await Le(K.value),w(),U("批量删除成功🌻")}catch{w(),T("批量删除失败，请刷新重试🌻")}}).catch(()=>{I("已取消🌻")})};return(o,e)=>{const V=i("el-input"),v=i("el-form-item"),C=i("el-option"),M=i("el-select"),_=i("el-button"),J=i("el-form"),f=i("el-col"),ge=i("KoiToolbar"),W=i("el-row"),y=i("el-table-column"),_e=i("KoiTag"),be=i("el-switch"),H=i("el-tooltip"),ke=i("el-table"),Te=i("el-pagination"),he=i("el-input-number"),we=i("KoiDrawer"),Se=i("KoiCard"),Ve=A("debounce"),Ce=A("throttle"),x=A("auth"),xe=A("loading");return d(),R("div",Ye,[t(Se,null,{default:a(()=>[p(t(J,{inline:!0},{default:a(()=>[t(v,{label:"公告标题",prop:"noticeTitle"},{default:a(()=>[t(V,{placeholder:"请输入公告标题",modelValue:c.value.noticeTitle,"onUpdate:modelValue":e[0]||(e[0]=l=>c.value.noticeTitle=l),clearable:"",style:{width:"240px"},onKeyup:$(m,["enter","native"])},null,8,["modelValue"])]),_:1}),t(v,{label:"公告类型",prop:"noticeType"},{default:a(()=>[t(M,{placeholder:"请选择公告类型",modelValue:c.value.noticeType,"onUpdate:modelValue":e[1]||(e[1]=l=>c.value.noticeType=l),style:{width:"240px"},onKeyup:$(m,["enter","native"]),clearable:""},{default:a(()=>[(d(!0),R(Z,null,ee(B.value,l=>(d(),g(C,{key:l.dictValue,label:l.dictLabel,value:l.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(v,{label:"公告状态",prop:"noticeStatus"},{default:a(()=>[t(M,{placeholder:"请选择公告状态",modelValue:c.value.noticeStatus,"onUpdate:modelValue":e[2]||(e[2]=l=>c.value.noticeStatus=l),clearable:"",style:{width:"240px"},onKeyup:$(m,["enter","native"])},{default:a(()=>[t(C,{label:"启用",value:"0"}),t(C,{label:"停用",value:"1"})]),_:1},8,["modelValue"])]),_:1}),t(v,null,{default:a(()=>[p((d(),g(_,{type:"primary",icon:"search",plain:""},{default:a(()=>e[15]||(e[15]=[k("搜索")])),_:1,__:[15]})),[[Ve,ne]]),p((d(),g(_,{type:"danger",icon:"refresh",plain:""},{default:a(()=>e[16]||(e[16]=[k("重置")])),_:1,__:[16]})),[[Ce,ie]])]),_:1})]),_:1},512),[[te,P.value]]),t(W,{gutter:10},{default:a(()=>[p((d(),g(f,{span:1.5},{default:a(()=>[t(_,{type:"primary",icon:"plus",plain:"",onClick:e[3]||(e[3]=l=>se())},{default:a(()=>e[17]||(e[17]=[k("新增")])),_:1,__:[17]})]),_:1})),[[x,["system:role:add"]]]),p((d(),g(f,{span:1.5},{default:a(()=>[t(_,{type:"success",icon:"edit",plain:"",onClick:e[4]||(e[4]=l=>G()),disabled:Q.value},{default:a(()=>e[18]||(e[18]=[k("修改")])),_:1,__:[18]},8,["disabled"])]),_:1})),[[x,["system:role:update"]]]),p((d(),g(f,{span:1.5},{default:a(()=>[t(_,{type:"danger",icon:"delete",plain:"",onClick:e[5]||(e[5]=l=>ye()),disabled:j.value},{default:a(()=>e[19]||(e[19]=[k("删除")])),_:1,__:[19]},8,["disabled"])]),_:1})),[[x,["system:role:delete"]]]),p((d(),g(f,{span:1.5},{default:a(()=>[t(_,{type:"warning",icon:"download",plain:""},{default:a(()=>e[20]||(e[20]=[k("导出")])),_:1,__:[20]})]),_:1})),[[x,["system:role:export"]]]),t(ge,{showSearch:P.value,"onUpdate:showSearch":e[6]||(e[6]=l=>P.value=l),onRefreshTable:m},null,8,["showSearch"])]),_:1}),e[21]||(e[21]=X("br",null,null,-1)),p((d(),g(ke,{border:"",data:F.value,"empty-text":"暂时没有数据哟🌻",onSelectionChange:ue},{default:a(()=>[t(y,{type:"selection",width:"55",align:"center"}),t(y,{label:"序号",prop:"noticeId",width:"120px",align:"center",type:"index"}),t(y,{label:"公告名称",prop:"noticeTitle",width:"260px",align:"center","show-overflow-tooltip":!0}),t(y,{label:"公告类型",prop:"noticeType",width:"100px",align:"center"},{default:a(l=>[t(_e,{tagOptions:B.value,value:l.row.noticeType},null,8,["tagOptions","value"])]),_:1}),t(y,{label:"公告状态",prop:"noticeStatus",width:"100px",align:"center"},{default:a(l=>[t(be,{modelValue:l.row.noticeStatus,"onUpdate:modelValue":z=>l.row.noticeStatus=z,"active-text":"启用","inactive-text":"停用","active-value":"0","inactive-value":"1","inline-prompt":!0,onChange:z=>ve(l.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),t(y,{label:"公告备注",prop:"remark",width:"260px",align:"center","show-overflow-tooltip":!0}),t(y,{label:"创建时间",prop:"createTime",width:"180px",align:"center"}),t(y,{label:"修改时间",prop:"updateTime",width:"180px",align:"center"}),t(y,{label:"修改人",prop:"updateBy",width:"180px",align:"center"}),t(y,{label:"操作",align:"center",width:"120",fixed:"right"},{default:a(({row:l})=>[t(H,{content:"修改🌻",placement:"top"},{default:a(()=>[p(t(_,{type:"primary",icon:"Edit",circle:"",plain:"",onClick:z=>G(l)},null,8,["onClick"]),[[x,["system:role:update"]]])]),_:2},1024),t(H,{content:"删除🌻",placement:"top"},{default:a(()=>[p(t(_,{type:"danger",icon:"Delete",circle:"",plain:"",onClick:z=>fe(l)},null,8,["onClick"]),[[x,["system:role:delete"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[xe,L.value]]),e[22]||(e[22]=X("br",null,null,-1)),p(t(Te,{background:"","current-page":c.value.pageNo,"onUpdate:currentPage":e[7]||(e[7]=l=>c.value.pageNo=l),"page-size":c.value.pageSize,"onUpdate:pageSize":e[8]||(e[8]=l=>c.value.pageSize=l),"page-sizes":[10,20,50,100,200],layout:"total, sizes, prev, pager, next, jumper",total:D.value,onSizeChange:m,onCurrentChange:m},null,8,["current-page","page-size","total"]),[[te,D.value>0]]),t(we,{ref_key:"koiDrawerRef",ref:S,title:Y.value,onKoiConfirm:pe,onKoiCancel:me,loading:b.value},{content:a(()=>[t(J,{ref_key:"formRef",ref:E,rules:de,model:s(n),"label-width":"80px","status-icon":""},{default:a(()=>[t(W,null,{default:a(()=>[t(f,{xs:{span:24},sm:{span:24}},{default:a(()=>[t(v,{label:"公告名称",prop:"noticeTitle"},{default:a(()=>[t(V,{modelValue:s(n).noticeTitle,"onUpdate:modelValue":e[9]||(e[9]=l=>s(n).noticeTitle=l),placeholder:"请输入公告名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),t(f,{xs:{span:24},sm:{span:24}},{default:a(()=>[t(v,{label:"公告类型",prop:"noticeType"},{default:a(()=>[t(M,{placeholder:"请选择公告类型",modelValue:s(n).noticeType,"onUpdate:modelValue":e[10]||(e[10]=l=>s(n).noticeType=l),clearable:""},{default:a(()=>[(d(!0),R(Z,null,ee(B.value,l=>(d(),g(C,{key:l.dictValue,label:l.dictLabel,value:l.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(f,{xs:{span:24},sm:{span:24}},{default:a(()=>[t(v,{label:"公告状态",prop:"noticeStatus"},{default:a(()=>[t(M,{modelValue:s(n).noticeStatus,"onUpdate:modelValue":e[11]||(e[11]=l=>s(n).noticeStatus=l),placeholder:"请选择公告状态",clearable:""},{default:a(()=>[t(C,{label:"启用",value:"0"}),t(C,{label:"停用",value:"1"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(f,{xs:{span:24},sm:{span:24}},{default:a(()=>[t(v,{label:"公告内容",prop:"noticeContent"},{default:a(()=>[t(V,{modelValue:s(n).noticeContent,"onUpdate:modelValue":e[12]||(e[12]=l=>s(n).noticeContent=l),placeholder:"请输入公告内容",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),t(f,{xs:{span:24},sm:{span:24}},{default:a(()=>[t(v,{label:"排序",prop:"sorted"},{default:a(()=>[t(he,{modelValue:s(n).sorted,"onUpdate:modelValue":e[13]||(e[13]=l=>s(n).sorted=l),min:0,step:1,placeholder:"请输入数字"},null,8,["modelValue"])]),_:1})]),_:1}),t(f,{xs:{span:24},sm:{span:24}},{default:a(()=>[t(v,{label:"公告备注",prop:"remark"},{default:a(()=>[t(V,{modelValue:s(n).remark,"onUpdate:modelValue":e[14]||(e[14]=l=>s(n).remark=l),rows:5,type:"textarea",placeholder:"请输入公告备注"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["rules","model"]),k(" "+Ue(s(n)),1)]),_:1},8,["title","loading"])]),_:1,__:[21,22]})])}}});export{$e as default};
