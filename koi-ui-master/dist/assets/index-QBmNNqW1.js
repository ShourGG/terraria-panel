import{d as le,l as u,o as De,m as Ue,r as s,b as B,c as Me,e as _,a as l,w as a,f as d,g as Q,z as Y,n as h,B as k,a1 as ee,q as f,s as ze,k as C,E as x,a2 as N,a3 as j,a4 as P,a5 as Re,ak as Te}from"./index-DpLe_dtH.js";import{u as Be,a as Pe,b as $e,d as Ee,c as qe,l as Le,g as Oe}from"./index-D8VyoKhn.js";import{h as Ae,i as Qe,s as Ye}from"./index-DaxHQChT.js";const je={class:"koi-flex"},Fe=le({name:"rolePage"}),Ge=le({...Fe,setup(He){const ae=u(!1),$=u(!0),F=u([{roleId:1,roleName:"YU-ADMINðŸŒ»",roleCode:"YU-ADMIN",roleStatus:"0",sorted:1,remark:"è¶…çº§ç®¡ç†å‘˜",createTime:"2023-08-08 23:00:00"},{roleId:2,roleName:"å¼ å¤§ä»™",roleCode:"ZDX",roleStatus:"0",sorted:2,remark:"è™Žç‰™688ï¼Œæ¯æ™šä¸ƒç‚¹åŠï¼Œä¸è§ä¸æ•£ï¼",createTime:"2023-08-08 23:00:00"},{roleId:3,roleName:"èœé¸¡",roleCode:"COMMON",roleStatus:"1",sorted:3,remark:"å¹²é¥­",createTime:"2023-08-08 23:00:00"}]),i=u({pageNo:1,pageSize:10,roleName:"",roleStatus:"",roleCode:""}),R=u(0),te=()=>{i.value={pageNo:1,pageSize:10,roleName:"",roleStatus:"",roleCode:""}},oe=()=>{i.value.pageNo=1,v()},ne=()=>{te(),v()},v=async()=>{R.value=9},I=async()=>{try{const t=await Le(i.value);F.value=t.data.records,R.value=t.data.total}catch{N("æ•°æ®æŸ¥è¯¢å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ðŸŒ»")}};De(()=>{v()});const V=u([]),E=u(!0),H=u(!0),re=t=>{V.value=t.map(e=>e.roleId),E.value=t.length!=1,H.value=!t.length},se=()=>{D(),K.value="è§’è‰²æ·»åŠ ",r.value.roleStatus="0",S.value.koiOpen(),C("æ·»åŠ ðŸŒ»")},ue=async t=>{if(t==null||t==""){P("è¯·é€‰æ‹©éœ€è¦ä¿®æ”¹çš„æ•°æ®ðŸŒ»");return}try{const e=await Oe(t);r.value=e.data}catch{N("æ•°æ®èŽ·å–å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ðŸŒ»")}},W=async t=>{D(),K.value="è§’è‰²ä¿®æ”¹";const e=t?t.roleId:V.value[0];(e==null||e=="")&&x("è¯·é€‰æ‹©éœ€è¦ä¿®æ”¹çš„æ•°æ®ðŸŒ»"),ue(e),S.value.koiOpen(),C("ä¿®æ”¹ðŸŒ»")},S=u(),K=u("è§’è‰²ç®¡ç†"),q=u();let r=u({roleId:null,roleName:null,roleCode:null,roleStatus:null,sorted:1,remark:null});const D=()=>{r.value={roleId:null,roleName:null,roleCode:null,roleStatus:null,sorted:1,remark:null}},de=Ue({roleName:[{required:!0,message:"è¯·è¾“å…¥è§’è‰²åå­—",trigger:"null"}],roleCode:[{required:!0,message:"è¯·è¾“å…¥è§’è‰²ç¼–å·",trigger:"null"}],roleStatus:[{required:!0,message:"è¯·è¾“å…¥é€‰æ‹©è§’è‰²çŠ¶æ€",trigger:"null"}],sorted:[{required:!0,message:"è¯·è¾“å…¥æŽ’åºå·",trigger:"null"}]}),g=u(!1),ie=()=>{q.value&&(g.value=!0,q.value.validate(async t=>{if(t)if(r.value.roleId!=null&&r.value.roleId!="")try{await Be(r.value),C("ä¿®æ”¹æˆåŠŸðŸŒ»"),g.value=!1,S.value.koiQuickClose(),D(),v()}catch{g.value=!1,N("ä¿®æ”¹å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ðŸŒ»")}else try{await Pe(r.value),C("æ·»åŠ æˆåŠŸðŸŒ»"),g.value=!1,S.value.koiQuickClose(),D(),v()}catch{g.value=!1,N("æ·»åŠ å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ðŸŒ»")}else x("éªŒè¯å¤±è´¥ï¼Œè¯·æ£€æŸ¥å¡«å†™å†…å®¹ðŸŒ»"),g.value=!1}))},pe=()=>{S.value.koiClose()},ce=t=>{let e=t.roleStatus==="0"?"å¯ç”¨":"åœç”¨";j("ç¡®è®¤è¦["+e+"]-["+t.roleName+"]è§’è‰²å—ï¼Ÿ").then(async()=>{if(D(),!t.roleId||!t.roleStatus){P("è¯·é€‰æ‹©éœ€è¦ä¿®æ”¹çš„æ•°æ®ðŸŒ»");return}try{await $e(t.roleId,t.roleStatus),C("ä¿®æ”¹æˆåŠŸðŸŒ»")}catch{I(),N("ä¿®æ”¹å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ðŸŒ»")}}).catch(()=>{x("å·²å–æ¶ˆðŸŒ»")})},me=t=>{const e=t.roleId;if(e==null||e==""){P("è¯·é€‰ä¸­éœ€è¦åˆ é™¤çš„æ•°æ®ðŸŒ»");return}j("æ‚¨ç¡®è®¤éœ€è¦åˆ é™¤è§’è‰²åç§°["+t.roleName+"]ä¹ˆï¼Ÿ").then(async()=>{try{await Ee(e),I(),C("åˆ é™¤æˆåŠŸðŸŒ»")}catch{N("åˆ é™¤å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ðŸŒ»"),I()}}).catch(()=>{x("å·²å–æ¶ˆðŸŒ»")})},fe=()=>{if(V.value.length==0){Re("è¯·é€‰æ‹©éœ€è¦åˆ é™¤çš„æ•°æ®ðŸŒ»");return}j("æ‚¨ç¡®è®¤éœ€è¦è¿›è¡Œæ‰¹é‡åˆ é™¤ä¹ˆï¼Ÿ").then(async()=>{try{await qe(V.value),I(),C("æ‰¹é‡åˆ é™¤æˆåŠŸðŸŒ»")}catch{N("æ‰¹é‡åˆ é™¤å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ðŸŒ»"),I()}}).catch(()=>{x("å·²å–æ¶ˆðŸŒ»")})},L=u(),U=u(),X=u([{menuId:1,menuName:"ç³»ç»Ÿç®¡ç†",children:[{menuId:4,menuName:"æ—¥å¿—ç®¡ç†",children:[{menuId:9,menuName:"ç™»å½•æ—¥å¿—"},{menuId:10,menuName:"æ“ä½œæ—¥å¿—"}]}]},{menuId:2,menuName:"ç›‘æŽ§ç®¡ç†",children:[{menuId:5,menuName:"Redisç›‘æŽ§"},{menuId:6,menuName:"æœåŠ¡å™¨ç›‘æŽ§"}]},{menuId:3,menuName:"èµ„æºç®¡ç†",children:[{menuId:7,menuName:"æ–‡ä»¶ç®¡ç†"},{menuId:8,menuName:"å›¾ç‰‡ç®¡ç†"}]}]),ve={id:"menuId",label:"menuName",children:"children"},Z=u(),M=u(),G=async t=>{var e,p;if(K.value="åˆ†é…èœå•ðŸŒ»",(e=U.value)==null||e.setCheckedKeys([],!1),M.value=(t==null?void 0:t.roleId)||V.value[0],M.value==null||M.value==""){P("è¯·é€‰ä¸­éœ€è¦åˆ†é…èœå•çš„æ•°æ®ðŸŒ»");return}L.value.koiOpen();try{const n=await Ae();X.value=Te(n.data.menuList,"menuId"),Z.value=n.data.spreadList}catch{x("èœå•èµ„æºåŠ è½½å¤±è´¥ðŸŒ»")}try{const n=await Qe(M.value);n.data&&((p=U.value)==null||p.setCheckedKeys(n.data,!1))}catch{x("è§’è‰²èœå•èµ„æºåŠ è½½å¤±è´¥ðŸŒ»")}},_e=async()=>{var n,w;g.value=!0;const t=(n=U.value)==null?void 0:n.getCheckedKeys(!1),p=((w=U.value)==null?void 0:w.getHalfCheckedKeys()).concat(t);try{await Ye(M.value,p),g.value=!1,C("è§’è‰²èœå•ä¿å­˜æˆåŠŸðŸŒ»"),window.location.reload}catch{x("è§’è‰²èœå•ä¿å­˜å¤±è´¥ðŸŒ»")}},ge=()=>{L.value.koiClose()};return(t,e)=>{const p=s("el-input"),n=s("el-form-item"),w=s("el-option"),O=s("el-select"),c=s("el-button"),J=s("el-form"),m=s("el-col"),ye=s("KoiToolbar"),T=s("el-row"),b=s("el-table-column"),he=s("el-switch"),A=s("el-tooltip"),ke=s("el-table"),be=s("el-pagination"),Ce=s("el-input-number"),xe=s("KoiDialog"),we=s("el-tree"),Ne=s("KoiDrawer"),Se=s("KoiCard"),Ie=B("throttle"),Ve=B("debounce"),y=B("auth"),Ke=B("loading");return _(),Me("div",je,[l(Se,null,{default:a(()=>[d(l(J,{inline:!0},{default:a(()=>[l(n,{label:"è§’è‰²åç§°",prop:"roleName"},{default:a(()=>[l(p,{placeholder:"è¯·è¾“å…¥è§’è‰²åç§°",modelValue:i.value.roleName,"onUpdate:modelValue":e[0]||(e[0]=o=>i.value.roleName=o),clearable:"",style:{width:"240px"},onKeyup:Y(v,["enter","native"])},null,8,["modelValue"])]),_:1}),l(n,{label:"è§’è‰²çŠ¶æ€",prop:"roleStatus"},{default:a(()=>[l(O,{placeholder:"è¯·é€‰æ‹©è§’è‰²çŠ¶æ€",modelValue:i.value.roleStatus,"onUpdate:modelValue":e[1]||(e[1]=o=>i.value.roleStatus=o),clearable:"",style:{width:"240px"},onKeyup:Y(v,["enter","native"])},{default:a(()=>[l(w,{label:"å¯ç”¨",value:"0"}),l(w,{label:"åœç”¨",value:"1"})]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"è§’è‰²ç¼–å·",prop:"roleCode"},{default:a(()=>[l(p,{placeholder:"è¯·è¾“å…¥è§’è‰²ç¼–å·",modelValue:i.value.roleCode,"onUpdate:modelValue":e[2]||(e[2]=o=>i.value.roleCode=o),clearable:"",style:{width:"240px"},onKeyup:Y(v,["enter","native"])},null,8,["modelValue"])]),_:1}),l(n,null,{default:a(()=>[d((_(),h(c,{type:"primary",icon:"search",plain:""},{default:a(()=>e[15]||(e[15]=[k("æœç´¢")])),_:1,__:[15]})),[[Ie,oe]]),d((_(),h(c,{type:"danger",icon:"refresh",plain:""},{default:a(()=>e[16]||(e[16]=[k("é‡ç½®")])),_:1,__:[16]})),[[Ve,ne]])]),_:1})]),_:1},512),[[ee,$.value]]),l(T,{gutter:10},{default:a(()=>[d((_(),h(m,{span:1.5},{default:a(()=>[l(c,{type:"primary",icon:"plus",plain:"",onClick:e[3]||(e[3]=o=>se())},{default:a(()=>e[17]||(e[17]=[k("æ–°å¢ž")])),_:1,__:[17]})]),_:1})),[[y,["system:role:add"]]]),d((_(),h(m,{span:1.5},{default:a(()=>[l(c,{type:"success",icon:"edit",plain:"",onClick:e[4]||(e[4]=o=>W()),disabled:E.value},{default:a(()=>e[18]||(e[18]=[k("ä¿®æ”¹")])),_:1,__:[18]},8,["disabled"])]),_:1})),[[y,["system:role:update"]]]),d((_(),h(m,{span:1.5},{default:a(()=>[l(c,{type:"danger",icon:"delete",plain:"",onClick:e[5]||(e[5]=o=>fe()),disabled:H.value},{default:a(()=>e[19]||(e[19]=[k("åˆ é™¤")])),_:1,__:[19]},8,["disabled"])]),_:1})),[[y,["system:role:delete"]]]),d((_(),h(m,{span:1.5},{default:a(()=>[l(c,{type:"warning",icon:"download",plain:""},{default:a(()=>e[20]||(e[20]=[k("å¯¼å‡º")])),_:1,__:[20]})]),_:1})),[[y,["system:role:export"]]]),d((_(),h(m,{span:1.5},{default:a(()=>[l(c,{type:"info",icon:"upload",plain:""},{default:a(()=>e[21]||(e[21]=[k("å¯¼å…¥")])),_:1,__:[21]})]),_:1})),[[y,["system:role:import"]]]),d((_(),h(m,{span:1.5},{default:a(()=>[l(c,{type:"success",icon:"Postcard",plain:"",disabled:E.value,onClick:e[6]||(e[6]=o=>G())},{default:a(()=>e[22]||(e[22]=[k("åˆ†é…èœå•")])),_:1,__:[22]},8,["disabled"])]),_:1})),[[y,["system:role:import"]]]),d((_(),h(m,{span:1.5},{default:a(()=>[l(c,{type:"info",icon:"upload",plain:""},{default:a(()=>e[23]||(e[23]=[k("æµ‹è¯•")])),_:1,__:[23]})]),_:1})),[[y,["system:role:xxx"]]]),l(ye,{showSearch:$.value,"onUpdate:showSearch":e[7]||(e[7]=o=>$.value=o),onRefreshTable:v},null,8,["showSearch"])]),_:1}),e[24]||(e[24]=Q("br",null,null,-1)),d((_(),h(ke,{border:"",data:F.value,"empty-text":"æš‚æ—¶æ²¡æœ‰æ•°æ®å“ŸðŸŒ»",onSelectionChange:re},{default:a(()=>[l(b,{type:"selection",width:"55",align:"center"}),l(b,{label:"åºå·",prop:"roleId",width:"120px",align:"center",type:"index"}),l(b,{label:"è§’è‰²åç§°",prop:"roleName",width:"120px","show-overflow-tooltip":!0,align:"center"}),l(b,{label:"è§’è‰²ç¼–å·",prop:"roleCode",width:"120px",align:"center"}),l(b,{label:"è§’è‰²çŠ¶æ€",prop:"roleStatus",width:"100px",align:"center"},{default:a(o=>[l(he,{modelValue:o.row.roleStatus,"onUpdate:modelValue":z=>o.row.roleStatus=z,"active-text":"å¯ç”¨","inactive-text":"åœç”¨","active-value":"0","inactive-value":"1","inline-prompt":!0,onChange:z=>ce(o.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),l(b,{label:"è§’è‰²æŽ’åº",prop:"sorted",width:"100px",align:"center"}),l(b,{label:"è§’è‰²å¤‡æ³¨",prop:"remark",width:"260px","show-overflow-tooltip":!0,align:"center"}),l(b,{label:"åˆ›å»ºæ—¶é—´",prop:"createTime",width:"180px",align:"center"}),l(b,{label:"æ“ä½œ",align:"center",width:"150",fixed:"right"},{default:a(({row:o})=>[l(A,{content:"ä¿®æ”¹ðŸŒ»",placement:"top"},{default:a(()=>[d(l(c,{type:"primary",icon:"Edit",circle:"",plain:"",onClick:z=>W(o)},null,8,["onClick"]),[[y,["system:role:update"]]])]),_:2},1024),l(A,{content:"åˆ é™¤ðŸŒ»",placement:"top"},{default:a(()=>[d(l(c,{type:"danger",icon:"Delete",circle:"",plain:"",onClick:z=>me(o)},null,8,["onClick"]),[[y,["system:role:delete"]]])]),_:2},1024),l(A,{content:"åˆ†é…èœå•ðŸŒ»",placement:"top"},{default:a(()=>[d(l(c,{type:"info",icon:"Postcard",circle:"",plain:"",onClick:z=>G(o)},null,8,["onClick"]),[[y,["system:role:delete"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[Ke,ae.value]]),e[25]||(e[25]=Q("br",null,null,-1)),d(l(be,{background:"","current-page":i.value.pageNo,"onUpdate:currentPage":e[8]||(e[8]=o=>i.value.pageNo=o),"page-size":i.value.pageSize,"onUpdate:pageSize":e[9]||(e[9]=o=>i.value.pageSize=o),"page-sizes":[10,20,50,100,200],layout:"total, sizes, prev, pager, next, jumper",total:R.value,onSizeChange:v,onCurrentChange:v},null,8,["current-page","page-size","total"]),[[ee,R.value>0]]),l(xe,{ref_key:"koiDialogRef",ref:S,title:K.value,onKoiConfirm:ie,onKoiCancel:pe,loading:g.value},{content:a(()=>[l(J,{ref_key:"formRef",ref:q,rules:de,model:f(r),"label-width":"80px","status-icon":""},{default:a(()=>[l(T,null,{default:a(()=>[l(m,{xs:{span:24},sm:{span:12}},{default:a(()=>[l(n,{label:"è§’è‰²åç§°",prop:"roleName"},{default:a(()=>[l(p,{modelValue:f(r).roleName,"onUpdate:modelValue":e[10]||(e[10]=o=>f(r).roleName=o),placeholder:"è¯·è¾“å…¥è§’è‰²åç§°",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(m,{xs:{span:24},sm:{span:12},class:"p-l-10px"},{default:a(()=>[l(n,{label:"è§’è‰²ç¼–å·",prop:"roleCode"},{default:a(()=>[l(p,{modelValue:f(r).roleCode,"onUpdate:modelValue":e[11]||(e[11]=o=>f(r).roleCode=o),placeholder:"è¯·è¾“å…¥è§’è‰²ç¼–å·",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(T,null,{default:a(()=>[l(m,{xs:{span:24},sm:{span:12}},{default:a(()=>[l(n,{label:"è§’è‰²çŠ¶æ€",prop:"roleStatus"},{default:a(()=>[l(O,{modelValue:f(r).roleStatus,"onUpdate:modelValue":e[12]||(e[12]=o=>f(r).roleStatus=o),placeholder:"è¯·é€‰æ‹©è§’è‰²çŠ¶æ€",style:{width:"260px"},clearable:""},{default:a(()=>[l(w,{label:"å¯ç”¨",value:"0"}),l(w,{label:"åœç”¨",value:"1"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(m,{xs:{span:24},sm:{span:12},class:"p-l-10px"},{default:a(()=>[l(n,{label:"è§’è‰²æŽ’åº",prop:"sorted"},{default:a(()=>[l(Ce,{modelValue:f(r).sorted,"onUpdate:modelValue":e[13]||(e[13]=o=>f(r).sorted=o),style:{width:"260px"},clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(T,null,{default:a(()=>[l(m,{xs:{span:24},sm:{span:24}},{default:a(()=>[l(n,{label:"è§’è‰²å¤‡æ³¨",prop:"remark"},{default:a(()=>[l(p,{modelValue:f(r).remark,"onUpdate:modelValue":e[14]||(e[14]=o=>f(r).remark=o),rows:5,type:"textarea",placeholder:"è¯·è¾“å…¥è§’è‰²å¤‡æ³¨"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["rules","model"]),k(" "+ze(f(r)),1)]),_:1},8,["title","loading"]),l(Ne,{ref_key:"koiDrawerRef",ref:L,title:K.value,size:"360",onKoiConfirm:_e,onKoiCancel:ge,loading:g.value,cancelText:"å…³é—­"},{content:a(()=>[Q("div",null,[l(we,{ref_key:"treeRef",ref:U,data:X.value,"show-checkbox":"","default-expand-all":!1,"default-expanded-keys":Z.value,"node-key":"menuId","highlight-current":"",props:ve},null,8,["data","default-expanded-keys"])])]),_:1},8,["title","loading"])]),_:1,__:[24,25]})])}}});export{Ge as default};
